Since this is working with threads, it is important to controle concurrent objects with locks:
https://superfastpython.com/lock-vs-semaphore-in-python/